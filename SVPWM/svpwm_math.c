#include "stdint.h"
#include "svpwm_math.h"

//Q14
const int32_t sine_table[SINE_TABLE_SIZE] = { 

	0,		286,	572,	857,	1143,	1428,	1713,	1997,	2280,	2563,	2845,	3126,	3406,	3686,	3964,	4240,	4516,	4790,
	5063,	5334,	5604,	5872,	6138,	6402,	6664,	6924,	7182,	7438,	7692,	7943,	8192,	8438,	8682,	8923,	9162,	9397,
	9630,	9860,	10087,	10311,	10531,	10749,	10963,	11174,	11381,	11585,	11786,	11982,	12176,	12365,	12551,	12733,	12911,	13085,
	13255,	13421,	13583,	13741,	13894,	14044,	14189,	14330,	14466,	14598,	14726,	14849,	14968,	15082,	15191,	15296,	15396,	15491,
	15582,	15668,	15749,	15826,	15897,	15964,	16026,	16083,	16135,	16182,	16225,	16262,	16294,	16322,	16344,	16362,	16374,	16382,
	16384,	16382,	16374,	16362,	16344,	16322,	16294,	16262,	16225,	16182,	16135,	16083,	16026,	15964,	15897,	15826,	15749,	15668,
	15582,	15491,	15396,	15296,	15191,	15082,	14968,	14849,	14726,	14598,	14466,	14330,	14189,	14044,	13894,	13741,	13583,	13421,
	13255,	13085,	12911,	12733,	12551,	12365,	12176,	11982,	11786,	11585,	11381,	11174,	10963,	10749,	10531,	10311,	10087,	9860,
	9630,	9397,	9162,	8923,	8682,	8438,	8192,	7943,	7692,	7438,	7182,	6924,	6664,	6402,	6138,	5872,	5604,	5334,
	5063,	4790,	4516,	4240,	3964,	3686,	3406,	3126,	2845,	2563,	2280,	1997,	1713,	1428,	1143,	857,	572,	286,
	0,		-286,	-572,	-857,	-1143,	-1428,	-1713,	-1997,	-2280,	-2563,	-2845,	-3126,	-3406,	-3686,	-3964,	-4240,	-4516,	-4790,
	-5063,	-5334,	-5604,	-5872,	-6138,	-6402,	-6664,	-6924,	-7182,	-7438,	-7692,	-7943,	-8192,	-8438,	-8682,	-8923,	-9162,	-9397,
	-9630,	-9860,	-10087, -10311, -10531, -10749, -10963, -11174, -11381, -11585, -11786, -11982, -12176, -12365, -12551, -12733, -12911, -13085,
	-13255, -13421, -13583, -13741, -13894, -14044, -14189, -14330, -14466, -14598, -14726, -14849, -14968, -15082, -15191, -15296, -15396, -15491,
	-15582, -15668, -15749, -15826, -15897, -15964, -16026, -16083, -16135, -16182, -16225, -16262, -16294, -16322, -16344, -16362, -16374, -16382,
	-16384, -16382, -16374, -16362, -16344, -16322, -16294, -16262, -16225, -16182, -16135, -16083, -16026, -15964, -15897, -15826, -15749, -15668,
	-15582, -15491, -15396, -15296, -15191, -15082, -14968, -14849, -14726, -14598, -14466, -14330, -14189, -14044, -13894, -13741, -13583, -13421,
	-13255, -13085, -12911, -12733, -12551, -12365, -12176, -11982, -11786, -11585, -11381, -11174, -10963, -10749, -10531, -10311, -10087, -9860,
	-9630,	-9397,	-9162,	-8923,	-8682,	-8438,	-8192,	-7943,	-7692,	-7438,	-7182,	-6924,	-6664,	-6402,	-6138,	-5872,	-5604,	-5334,
	-5063,	-4790,	-4516,	-4240,	-3964,	-3686,	-3406,	-3126,	-2845,	-2563,	-2280,	-1997,	-1713,	-1428,	-1143,	-857,	-572,	-286

}; 

//Cos_Q14 * sqrt_3
const int32_t consine_table[SINE_TABLE_SIZE] = {

	0,		495,	990,	1485,	1980,	2473,	2966,	3458,	3949,	4439,	4928,	5415,	5900,	6384,	6865,	7345,	7822,	8297,
	8769,	9239,	9706,	10170,	10631,	11088,	11542,	11993,	12440,	12883,	13323,	13758,	14189,	14616,	15038,	15456,	15869,	16277,
	16680,	17078,	17471,	17859,	18241,	18618,	18989,	19354,	19713,	20066,	20413,	20754,	21089,	21417,	21739,	22054,	22362,	22664,
	22958,	23246,	23526,	23800,	24066,	24325,	24576,	24820,	25056,	25285,	25506,	25719,	25925,	26122,	26312,	26493,	26667,	26832,
	26989,	27138,	27279,	27411,	27535,	27651,	27758,	27857,	27947,	28029,	28102,	28166,	28222,	28270,	28309,	28339,	28361,	28374,
	28378,	28374,	28361,	28339,	28309,	28270,	28222,	28166,	28102,	28029,	27947,	27857,	27758,	27651,	27535,	27411,	27279,	27138,
	26989,	26832,	26667,	26493,	26312,	26122,	25925,	25719,	25506,	25285,	25056,	24820,	24576,	24325,	24066,	23800,	23526,	23246,
	22958,	22664,	22362,	22054,	21739,	21417,	21089,	20754,	20413,	20066,	19713,	19354,	18989,	18618,	18241,	17859,	17471,	17078,
	16680,	16277,	15869,	15456,	15038,	14616,	14189,	13758,	13323,	12883,	12440,	11993,	11542,	11088,	10631,	10170,	9706,	9239,
	8769,	8297,	7822,	7345,	6865,	6384,	5900,	5415,	4928,	4439,	3949,	3458,	2966,	2473,	1980,	1485,	990,	495,
	0,		-495,	-990,	-1485,	-1980,	-2473,	-2966,	-3458,	-3949,	-4439,	-4928,	-5415,	-5900,	-6384,	-6865,	-7345,	-7822,	-8297,
	-8769,	-9239,	-9706,	-10170, -10631, -11088, -11542, -11993, -12440, -12883, -13323, -13758, -14189, -14616, -15038, -15456, -15869, -16277,
	-16680, -17078, -17471, -17859, -18241, -18618, -18989, -19354, -19713, -20066, -20413, -20754, -21089, -21417, -21739, -22054, -22362, -22664,
	-22958, -23246, -23526, -23800, -24066, -24325, -24576, -24820, -25056, -25285, -25506, -25719, -25925, -26122, -26312, -26493, -26667, -26832,
	-26989, -27138, -27279, -27411, -27535, -27651, -27758, -27857, -27947, -28029, -28102, -28166, -28222, -28270, -28309, -28339, -28361, -28374,
	-28378, -28374, -28361, -28339, -28309, -28270, -28222, -28166, -28102, -28029, -27947, -27857, -27758, -27651, -27535, -27411, -27279, -27138,
	-26989, -26832, -26667, -26493, -26312, -26122, -25925, -25719, -25506, -25285, -25056, -24820, -24576, -24325, -24066, -23800, -23526, -23246,
	-22958, -22664, -22362, -22054, -21739, -21417, -21089, -20754, -20413, -20066, -19713, -19354, -18989, -18618, -18241, -17859, -17471, -17078,
	-16680, -16277, -15869, -15456, -15038, -14616, -14189, -13758, -13323, -12883, -12440, -11993, -11542, -11088, -10631, -10170, -9706,	-9239,
	-8769,	-8297,	-7822,	-7345,	-6865,	-6384,	-5900,	-5415,	-4928,	-4439,	-3949,	-3458,	-2966,	-2473,	-1980,	-1485,	-990,	-495
}; 



const int16_t sine_table_8192[SINE_TABLE_SIZE] = { 
	0,143,286,429,571,714,856,998,1140,1282,1423,1563,1703,1843,1982,2120,2258,2395,
	2531,2667,2802,2936,3069,3201,3332,3462,3591,3719,3846,3972,4096,4219,4341,4462,4581,4699,
	4815,4930,5043,5155,5266,5374,5482,5587,5691,5793,5893,5991,6088,6183,6275,6366,6455,6542,
	6627,6710,6791,6870,6947,7022,7094,7165,7233,7299,7363,7424,7484,7541,7595,7648,7698,7746,
	7791,7834,7875,7913,7949,7982,8013,8041,8068,8091,8112,8131,8147,8161,8172,8181,8187,8191,
	8192,8191,8187,8181,8172,8161,8147,8131,8112,8091,8068,8041,8013,7982,7949,7913,7875,7834,
	7791,7746,7698,7648,7595,7541,7484,7424,7363,7299,7233,7165,7094,7022,6947,6870,6791,6710,
	6627,6542,6455,6366,6275,6183,6088,5991,5893,5793,5691,5587,5482,5374,5266,5155,5043,4930,
	4815,4699,4581,4462,4341,4219,4096,3972,3846,3719,3591,3462,3332,3201,3069,2936,2802,2667,
	2531,2395,2258,2120,1982,1843,1703,1563,1423,1282,1140,998,856,714,571,429,286,143,
	0,-143,-286,-429,-571,-714,-856,-998,-1140,-1282,-1423,-1563,-1703,-1843,-1982,-2120,-2258,-2395,
	-2531,-2667,-2802,-2936,-3069,-3201,-3332,-3462,-3591,-3719,-3846,-3972,-4096,-4219,-4341,-4462,-4581,-4699,
	-4815,-4930,-5043,-5155,-5266,-5374,-5482,-5587,-5691,-5793,-5893,-5991,-6088,-6183,-6275,-6366,-6455,-6542,
	-6627,-6710,-6791,-6870,-6947,-7022,-7094,-7165,-7233,-7299,-7363,-7424,-7484,-7541,-7595,-7648,-7698,-7746,
	-7791,-7834,-7875,-7913,-7949,-7982,-8013,-8041,-8068,-8091,-8112,-8131,-8147,-8161,-8172,-8181,-8187,-8191,
	-8192,-8191,-8187,-8181,-8172,-8161,-8147,-8131,-8112,-8091,-8068,-8041,-8013,-7982,-7949,-7913,-7875,-7834,
	-7791,-7746,-7698,-7648,-7595,-7541,-7484,-7424,-7363,-7299,-7233,-7165,-7094,-7022,-6947,-6870,-6791,-6710,
	-6627,-6542,-6455,-6366,-6275,-6183,-6088,-5991,-5893,-5793,-5691,-5587,-5482,-5374,-5266,-5155,-5043,-4930,
	-4815,-4699,-4581,-4462,-4341,-4219,-4096,-3972,-3846,-3719,-3591,-3462,-3332,-3201,-3069,-2936,-2802,-2667,
	-2531,-2395,-2258,-2120,-1982,-1843,-1703,-1563,-1423,-1282,-1140,-998,-856,-714,-571,-429,-286,-143
}; 


const int16_t consine_table_8192[SINE_TABLE_SIZE] = {

	0,248,495,743,990,1237,1483,1729,1975,2220,2464,2707,2950,3192,3433,3672,3911,4148,
	4385,4619,4853,5085,5315,5544,5771,5997,6220,6442,6661,6879,7094,7308,7519,7728,7934,8138,
	8340,8539,8736,8929,9120,9309,9494,9677,9856,10033,10207,10377,10544,10709,10869,11027,11181,11332,
	11479,11623,11763,11900,12033,12162,12288,12410,12528,12642,12753,12860,12962,13061,13156,13247,13333,13416,
	13495,13569,13639,13705,13767,13825,13879,13928,13973,14014,14051,14083,14111,14135,14154,14170,14180,14187,
	14189,14187,14180,14170,14154,14135,14111,14083,14051,14014,13973,13928,13879,13825,13767,13705,13639,13569,
	13495,13416,13333,13247,13156,13061,12962,12860,12753,12642,12528,12410,12288,12162,12033,11900,11763,11623,
	11479,11332,11181,11027,10869,10709,10544,10377,10207,10033,9856,9677,9494,9309,9120,8929,8736,8539,
	8340,8138,7934,7728,7519,7308,7094,6879,6661,6442,6220,5997,5771,5544,5315,5085,4853,4619,
	4385,4148,3911,3672,3433,3192,2950,2707,2464,2220,1975,1729,1483,1237,990,743,495,248,
	0,-248,-495,-743,-990,-1237,-1483,-1729,-1975,-2220,-2464,-2707,-2950,-3192,-3433,-3672,-3911,-4148,
	-4385,-4619,-4853,-5085,-5315,-5544,-5771,-5997,-6220,-6442,-6661,-6879,-7094,-7308,-7519,-7728,-7934,-8138,
	-8340,-8539,-8736,-8929,-9120,-9309,-9494,-9677,-9856,-10033,-10207,-10377,-10544,-10709,-10869,-11027,-11181,-11332,
	-11479,-11623,-11763,-11900,-12033,-12162,-12288,-12410,-12528,-12642,-12753,-12860,-12962,-13061,-13156,-13247,-13333,-13416,
	-13495,-13569,-13639,-13705,-13767,-13825,-13879,-13928,-13973,-14014,-14051,-14083,-14111,-14135,-14154,-14170,-14180,-14187,
	-14189,-14187,-14180,-14170,-14154,-14135,-14111,-14083,-14051,-14014,-13973,-13928,-13879,-13825,-13767,-13705,-13639,-13569,
	-13495,-13416,-13333,-13247,-13156,-13061,-12962,-12860,-12753,-12642,-12528,-12410,-12288,-12162,-12033,-11900,-11763,-11623,
	-11479,-11332,-11181,-11027,-10869,-10709,-10544,-10377,-10207,-10033,-9856,-9677,-9494,-9309,-9120,-8929,-8736,-8539,
	-8340,-8138,-7934,-7728,-7519,-7308,-7094,-6879,-6661,-6442,-6220,-5997,-5771,-5544,-5315,-5085,-4853,-4619,
	-4385,-4148,-3911,-3672,-3433,-3192,-2950,-2707,-2464,-2220,-1975,-1729,-1483,-1237,-990,-743,-495,-248
}; 



/**
  * @brief  This function transforms stator currents Ia and qIb (which are
  *         directed along axes each displaced by 120 degrees) into currents
  *         Ialpha and Ibeta in a stationary qd reference frame.
  *                               Ialpha = Ia
  *                       Ibeta = -(2*Ib+Ia)/sqrt(3)
  * @param  Curr_Input: stator current Ia and Ib in Curr_Components format
  * @retval Stator current Ialpha and Ibeta in Curr_Components format
  */
Curr_Components clarke( Curr_Components Curr_Input )
{
	Curr_Components out_curr;
	return out_curr;
}

/**
  * @brief  This function transforms stator currents Ialpha and Ibeta, which
  *         belong to a stationary qd reference frame, to a rotor flux
  *         synchronous reference frame (properly oriented), so as Iq and Id.
  *                   Id= Ialpha *sin(theta)+qIbeta *cos(Theta)
  *                   Iq=qIalpha *cos(Theta)-qIbeta *sin(Theta)
  * @param  Curr_Input: stator current Ialpha and Ibeta in Curr_Components format
  * @param  Theta: rotating frame angular position in q1.15 format
  * @retval Stator current Iq and Id in Curr_Components format
  */
Curr_Components park( Curr_Components Curr_Input, int16_t Theta )
{
	Curr_Components out_curr;
	return out_curr;
}

/**
  * @brief  This function transforms stator voltage qVq and qVd, that belong to
  *         a rotor flux synchronous rotating frame, to a stationary reference
  *         frame, so as to obtain qValpha and qVbeta:
  *                  Valfa= Vq*Cos(theta)+ Vd*Sin(theta)
  *                  Vbeta=-Vq*Sin(theta)+ Vd*Cos(theta)
  * @param  Curr_Input: stator voltage Vq and Vd in Volt_Components format
  * @param  Theta: rotating frame angular position in q1.15 format
  * @retval Stator voltage Valpha and Vbeta in Volt_Components format
  */
Volt_Components rev_park( Volt_Components Volt_Input, int16_t Theta )
{
	Volt_Components out_volt;
	return out_volt;
}


/**
  * @brief  This function returns cosine and sine functions of the angle fed in
  *         input
  * @param  hAngle: angle in q1.15 format
  * @retval Trig_Components Cos(angle) and Sin(angle) in Trig_Components format
  */
Trig_Components trig_functions( int16_t hAngle )
{
	Trig_Components out_trig;
	return out_trig;
}







